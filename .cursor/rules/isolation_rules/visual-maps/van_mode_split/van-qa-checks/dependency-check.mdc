---
description: Process map for VAN QA dependency verification
globs: dependency-check.mdc
alwaysApply: false
---
# VAN QAï¼šä¾èµ–éªŒè¯

> **ç®€è¦è¯´æ˜ï¼š** æ­¤ç»„ä»¶éªŒè¯æ‰€æœ‰å¿…éœ€çš„ä¾èµ–é¡¹å·²å®‰è£…å¹¶ä¸é¡¹ç›®è¦æ±‚å…¼å®¹ã€‚

## 1ï¸âƒ£ ä¾èµ–éªŒè¯æµç¨‹

```mermaid
graph TD
    Start["ä¾èµ–éªŒè¯"] --> ReadDeps["ä»åˆ›æ„é˜¶æ®µè¯»å–<br>å¿…éœ€ä¾èµ–"]
    ReadDeps --> CheckInstalled["æ£€æŸ¥ä¾èµ–<br>æ˜¯å¦å·²å®‰è£…"]
    CheckInstalled --> DepStatus{"æ‰€æœ‰ä¾èµ–<br>å·²å®‰è£…ï¼Ÿ"}
    
    DepStatus -->|"æ˜¯"| VerifyVersions["éªŒè¯ç‰ˆæœ¬<br>å’Œå…¼å®¹æ€§"]
    DepStatus -->|"å¦"| InstallMissing["å®‰è£…ç¼ºå¤±<br>ä¾èµ–"]
    InstallMissing --> VerifyVersions
    
    VerifyVersions --> VersionStatus{"ç‰ˆæœ¬<br>å…¼å®¹ï¼Ÿ"}
    VersionStatus -->|"æ˜¯"| DepSuccess["ä¾èµ–éªŒè¯<br>âœ… é€šè¿‡"]
    VersionStatus -->|"å¦"| UpgradeVersions["æ ¹æ®éœ€è¦<br>å‡çº§/é™çº§"]
    UpgradeVersions --> RetryVerify["é‡è¯•éªŒè¯"]
    RetryVerify --> VersionStatus
    
    style Start fill:#4da6ff,stroke:#0066cc,color:white
    style DepSuccess fill:#10b981,stroke:#059669,color:white
    style DepStatus fill:#f6546a,stroke:#c30052,color:white
    style VersionStatus fill:#f6546a,stroke:#c30052,color:white
```

### Windows (PowerShell) å®ç°ï¼š
```powershell
# ç¤ºä¾‹ï¼šéªŒè¯Reacté¡¹ç›®çš„Node.jsä¾èµ–
function Verify-Dependencies {
    $requiredDeps = @{ "node" = ">=14.0.0"; "npm" = ">=6.0.0" }
    $missingDeps = @(); $incompatibleDeps = @()
    
    # æ£€æŸ¥Node.jsç‰ˆæœ¬
    try { 
        $nodeVersion = node -v
        if ($nodeVersion -match "v(\d+)\.(\d+)\.(\d+)") {
            $major = [int]$Matches[1]
            if ($major -lt 14) {
                $incompatibleDeps += "node (æ‰¾åˆ° $nodeVersionï¼Œéœ€è¦ >=14.0.0)"
            }
        }
    } catch {
        $missingDeps += "node"
    }
    
    # æ£€æŸ¥npmç‰ˆæœ¬
    try { 
        $npmVersion = npm -v
        if ($npmVersion -match "(\d+)\.(\d+)\.(\d+)") {
            $major = [int]$Matches[1]
            if ($major -lt 6) {
                $incompatibleDeps += "npm (æ‰¾åˆ° $npmVersionï¼Œéœ€è¦ >=6.0.0)"
            }
        }
    } catch {
        $missingDeps += "npm"
    }
    
    # æ˜¾ç¤ºç»“æœ
    if ($missingDeps.Count -eq 0 -and $incompatibleDeps.Count -eq 0) {
        Write-Output "âœ… æ‰€æœ‰ä¾èµ–éªŒè¯ä¸”å…¼å®¹"
        return $true
    } else {
        if ($missingDeps.Count -gt 0) {
            Write-Output "âŒ ç¼ºå¤±ä¾èµ–ï¼š$($missingDeps -join ', ')"
        }
        if ($incompatibleDeps.Count -gt 0) {
            Write-Output "âŒ ä¸å…¼å®¹ç‰ˆæœ¬ï¼š$($incompatibleDeps -join ', ')"
        }
        return $false
    }
}
```

### Mac/Linux (Bash) å®ç°ï¼š
```bash
#!/bin/bash

# ç¤ºä¾‹ï¼šéªŒè¯Reacté¡¹ç›®çš„Node.jsä¾èµ–
verify_dependencies() {
    local missing_deps=()
    local incompatible_deps=()
    
    # æ£€æŸ¥Node.jsç‰ˆæœ¬
    if command -v node &> /dev/null; then
        local node_version=$(node -v)
        if [[ $node_version =~ v([0-9]+)\.([0-9]+)\.([0-9]+) ]]; then
            local major=${BASH_REMATCH[1]}
            if (( major < 14 )); then
                incompatible_deps+=("node (æ‰¾åˆ° $node_versionï¼Œéœ€è¦ >=14.0.0)")
            fi
        fi
    else
        missing_deps+=("node")
    fi
    
    # æ£€æŸ¥npmç‰ˆæœ¬
    if command -v npm &> /dev/null; then
        local npm_version=$(npm -v)
        if [[ $npm_version =~ ([0-9]+)\.([0-9]+)\.([0-9]+) ]]; then
            local major=${BASH_REMATCH[1]}
            if (( major < 6 )); then
                incompatible_deps+=("npm (æ‰¾åˆ° $npm_versionï¼Œéœ€è¦ >=6.0.0)")
            fi
        fi
    else
        missing_deps+=("npm")
    fi
    
    # æ˜¾ç¤ºç»“æœ
    if [ ${#missing_deps[@]} -eq 0 ] && [ ${#incompatible_deps[@]} -eq 0 ]; then
        echo "âœ… æ‰€æœ‰ä¾èµ–éªŒè¯ä¸”å…¼å®¹"
        return 0
    else
        if [ ${#missing_deps[@]} -gt 0 ]; then
            echo "âŒ ç¼ºå¤±ä¾èµ–ï¼š${missing_deps[*]}"
        fi
        if [ ${#incompatible_deps[@]} -gt 0 ]; then
            echo "âŒ ä¸å…¼å®¹ç‰ˆæœ¬ï¼š${incompatible_deps[*]}"
        fi
        return 1
    fi
}
```

## ğŸ“‹ ä¾èµ–éªŒè¯æ£€æŸ¥ç‚¹

```
âœ“ æ£€æŸ¥ç‚¹ï¼šä¾èµ–éªŒè¯
- å¿…éœ€ä¾èµ–å·²è¯†åˆ«ï¼Ÿ [æ˜¯/å¦]
- æ‰€æœ‰ä¾èµ–å·²å®‰è£…ï¼Ÿ [æ˜¯/å¦]
- æ‰€æœ‰ç‰ˆæœ¬å…¼å®¹ï¼Ÿ [æ˜¯/å¦]

â†’ å¦‚æœå…¨éƒ¨æ˜¯ï¼šç»§ç»­é…ç½®éªŒè¯ã€‚
â†’ å¦‚æœæœ‰å¦ï¼šåœ¨ç»§ç»­ä¹‹å‰ä¿®å¤ä¾èµ–é—®é¢˜ã€‚
```

**ä¸‹ä¸€æ­¥ï¼ˆé€šè¿‡æ—¶ï¼‰ï¼š** åŠ è½½`van-qa-checks/config-check.mdc`ã€‚
**ä¸‹ä¸€æ­¥ï¼ˆå¤±è´¥æ—¶ï¼‰ï¼š** æ£€æŸ¥`van-qa-utils/common-fixes.mdc`è·å–ä¾èµ–ä¿®å¤ã€‚ 