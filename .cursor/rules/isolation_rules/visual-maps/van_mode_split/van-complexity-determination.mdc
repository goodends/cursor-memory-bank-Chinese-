---
description: Visual process map for VAN mode complexity determination
globs: van-complexity-determination.mdc
alwaysApply: false
---
# VAN模式：复杂度确定

> **简要说明：** 此组件确定当前任务的适当复杂度级别（1-4），并相应地指导工作流程。

## 🔍 复杂度决策树

```mermaid
graph TD
    Start["新任务"] --> Q1{"错误修复或<br>错误纠正？"}
    Q1 -->|是| Q1a{"影响单个<br>组件？"}
    Q1a -->|是| L1["级别1：<br>快速错误修复"]
    Q1a -->|否| Q1b{"影响多个<br>组件？"}
    Q1b -->|是| L2["级别2：<br>简单增强"]
    Q1b -->|否| Q1c{"影响系统<br>架构？"}
    Q1c -->|是| L3["级别3：<br>中级功能"]
    Q1c -->|否| L2
    
    Q1 -->|否| Q2{"添加小功能<br>或增强？"}
    Q2 -->|是| Q2a{"自包含<br>更改？"}
    Q2a -->|是| L2
    Q2a -->|否| Q2b{"影响多个<br>组件？"}
    Q2b -->|是| L3
    Q2b -->|否| L2
    
    Q2 -->|否| Q3{"需要多个<br>组件的完整<br>功能？"}
    Q3 -->|是| Q3a{"架构<br>影响？"}
    Q3a -->|是| L4["级别4：<br>复杂系统"]
    Q3a -->|否| L3
    
    Q3 -->|否| Q4{"系统级或<br>架构<br>更改？"}
    Q4 -->|是| L4
    Q4 -->|否| L3

    style Start fill:#4da6ff,stroke:#0066cc,color:white
    style L1 fill:#10b981,stroke:#059669,color:white
    style L2 fill:#f6546a,stroke:#c30052,color:white
    style L3 fill:#f6546a,stroke:#c30052,color:white
    style L4 fill:#f6546a,stroke:#c30052,color:white
```

## 📋 级别指标

### 级别1：快速错误修复
- **关键词**：修复、错误、崩溃、问题
- **范围**：单个组件
- **时间**：分钟到小时
- **风险**：低，隔离的
- **示例**：按钮不工作、样式问题

### 级别2：简单增强
- **关键词**：添加、改进、更新、增强
- **范围**：单个组件/子系统
- **时间**：小时到1-2天
- **风险**：中等，受控的
- **示例**：添加表单字段、改进验证

### 级别3：中级功能
- **关键词**：实现、创建、开发
- **范围**：多个组件
- **时间**：天到1-2周
- **风险**：重大
- **示例**：用户认证、仪表板

### 级别4：复杂系统
- **关键词**：系统、架构、重新设计
- **范围**：多个子系统
- **时间**：周到月
- **风险**：高，架构性
- **示例**：支付系统、微服务

## 📋 复杂度检查清单

```
✓ 复杂度确定
- 任务类型已识别？ [是/否]
- 范围已评估？ [是/否]
- 时间已估算？ [是/否]
- 风险已评估？ [是/否]
- 依赖已映射？ [是/否]

→ 如果全部是：继续级别特定工作流程
→ 如果有否：完成评估
```

## 🔄 级别转换触发器

```mermaid
graph TD
    Current["当前级别"] --> Higher["升级触发器"]
    Current --> Lower["降级触发器"]
    
    Higher --> H1["多个组件"]
    Higher --> H2["设计决策"]
    Higher --> H3["系统影响"]
    
    Lower --> L1["隔离更改"]
    Lower --> L2["简单修复"]
    Lower --> L3["无需设计"]

    style Current fill:#4da6ff,stroke:#0066cc,color:white
    style Higher fill:#f6546a,stroke:#c30052,color:white
    style Lower fill:#10b981,stroke:#059669,color:white
```

## 📋 工作流程加载

基于确定的级别：
- 级别1：在VAN模式中继续
- 级别2-4：转换到PLAN模式

**下一步：** 加载适当的级别特定工作流程

## 🚨 模式转换触发器（VAN到PLAN）

如果复杂度确定为级别2、3或4：

```
🚫 检测到级别[2-4]任务
VAN模式中的实现被阻止
此任务需要PLAN模式
您必须切换到PLAN模式进行适当的文档和规划
输入'PLAN'切换到规划模式
```

## 📋 检查点验证模板（示例）

```
✓ 部分检查点：复杂度确定
- 任务已分析？ [是/否]
- 复杂度级别已确定？ [是/否]

→ 如果级别1：继续VAN模式完成。
→ 如果级别2-4：触发PLAN模式转换。
```

**下一步（级别1）：** 完成VAN初始化（例如，如果需要，初始化Memory Bank）。
**下一步（级别2-4）：** 退出VAN模式并启动PLAN模式。 